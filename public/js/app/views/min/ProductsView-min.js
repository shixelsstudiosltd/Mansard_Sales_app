define(["Mansard","backbone","marionette","jquery","models/Model","hbs!templates/products"],function(t,o,e,$,r,u){return o.Marionette.ItemView.extend({template:u,model:null,motor_products:null,life_products:null,product_type:null,product:null,events:{"click .choose-motor":"showMotorProducts","click .choose-life":"showLifeProducts","click .quote-motor":"startMotorQuote","click .quote-life":"startLifeQuote","click .quote-motor-button-btn":"getMotorQuote","click .quote-life-button-btn":"getLifeQuote","click .add-to-cart-button":"addToCart","click .back-menu-button":"handleBack","click .add-to-customer-button":"getCustomer"},initialize:function(){this.motor_products=t.api.products("motor"),this.life_products=t.api.products("life");for(var o=null,e=0;e<this.motor_products.length;e++)this.motor_products[e].IsWholeLife=this.motor_products[e].IsWholeLife?"1":"0";for(var u=0;u<this.life_products.length;u++)this.life_products[u].IsWholeLife=this.life_products[u].IsWholeLife?"1":"0";this.product={},o=t.customer?'<button class="btn btn-secondary add-to-cart-button">Add to Cart</button>':'<button class="btn btn-secondary add-to-customer-button">Add to Customer</button>',this.model=new r({motor:this.motor_products,life:this.life_products,quoteButton:o})},onRender:function(){this.$el=this.$el.children(),this.setElement(this.$el),$(".main-menu-button, #right-area-container").removeClass("close-main-nav active"),$("#main-nav-container, #right-area-container").animate({left:"0%"})},showMotorProducts:function(){$(".life-dropdown").slideUp(),$(".motor-dropdown").slideDown()},showLifeProducts:function(){$(".life-dropdown").slideDown(),$(".motor-dropdown").slideUp()},startMotorQuote:function(t){t.preventDefault();var o=$(".motor-drop").find("option:selected");$(".temp-search-result").hide(),$(".quote-title").html(o.val()),$(".quote-question-1").html('<label class="quote-question-1-label">Current value of vehicle(Sum Assured):</label><input class="quote-question-1-q" type="text" placeholder="e.g. 100,000">'),$(".quote-question-2").html('<label class="quote-question-2-label">Vehicle Category:</label><select class="quote-question-2-q"><option value="0">--Select Vehicle Category--</option><option value="1">Saloon</option><option value="95">SUV</option></select>'),$(".quote-button").html('<button class="btn btn-primary quote-motor-button-btn">Get Quote</button>'),this.product.product_type=o.data("productcode"),this.product.name=o.val(),this.product.product_id=o.data("productid"),this.product.product_class=o.data("productclassid"),this.product.wholelife=o.data("iswholelife")},startLifeQuote:function(t){t.preventDefault();var o=$(".life-drop").find("option:selected");$(".temp-search-result").hide(),this.product.product_type=o.data("productcode"),this.product.name=o.val(),this.product.product_id=o.data("productid"),this.product.product_class=o.data("productclassid"),this.product.wholelife=o.data("iswholelife"),this.getLifeQuote(this.product.productid)},getMotorQuote:function(o){if(o.preventDefault(),"0"!==$(".quote-question-2-q").val()&&$(".quote-question-1-q").val())if(isNaN($(".quote-question-1-q").val()))$(".quote-error").html('<div class="alert alert-warning" role="alert">Please enter value amount!</div>');else{$(".quote-error").fadeOut();var e=this.product.product_id,r={sumassured:$(".quote-question-1-q").val(),policy:e,bodyTypeCode:$(".quote-question-2-q").val()};this.product.sumassured=r.sumassured,this.product.bodytype=r.bodyTypeCode,this.product.img="default_product.png";var u=t.api.quote("motor",r);u=u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),this.product.quote=u,this.product.qty=1,this.product.customer=t.customer,this.product.price=u,$(".quote_amount").html(u),$(".quote_value").slideDown(),$(".quote-form").slideUp()}else $(".quote-error").html('<div class="alert alert-warning" role="alert">Please fill out all fields!</div>')},getLifeQuote:function(){var o=this.product.product_id,e={policy:o},r=t.api.quote("life",e);this.product.quote=r,this.product.qty=1,r.summassured?r=r.summassured.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):r.summassured="0",this.product.price=r,this.product.img="default_product.png",this.product.customer=t.customer,$(".quote_amount").html(r),$(".quote_value").slideDown(),$(".quote-form").slideUp()},addToCart:function(){t.cart.add(this.product);for(var o=0;o<t.cart.items.length;o++)t.cart.items[o].pos=o,t.cart.total+=t.cart.items[o].price.replace(/\D/g,"");this.total&&(this.total=this.total.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),$(".mini-card-total-holder").html(this.total),$(".cart-num").html(t.cart.count())},handleBack:function(){console.log("back"),o.history.back()},getCustomer:function(){t.tempProduct=this.product,t.appRouter.navigate("dashboard",{trigger:!0})}})});